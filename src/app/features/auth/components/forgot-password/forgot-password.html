<div class="auth-card">
  <div>
    <ng-container *ngIf="currentView === 'enterEmail'">
      <h3 class="form-title">Quên Mật Khẩu</h3>
      <p class="form-subtitle">Nhập email bên dưới để nhận liên kết.</p>

      <form [formGroup]="emailForm" (ngSubmit)="onEmailSubmit()">
        <div
          class="notification-bar"
          *ngIf="notification"
          [class.success]="notification.type === 'success'"
          [class.error]="notification.type === 'error'"
        >
          {{ notification.message }}
        </div>
        <div class="form-group">
          <input type="email" placeholder="Email" formControlName="email" />
        </div>

        <button type="submit" class="submit-button">Gửi Email</button>

        <p class="switch-link">
          Bạn đã nhớ mật khẩu? <a (click)="onLoginClick()">Quay lại trang đăng nhập</a>
        </p>
      </form>
    </ng-container>
  </div>
  <!-- === GIAO DIỆN 2: FORM NHẬP MÃ === -->
  <div>
    <ng-container *ngIf="currentView === 'enterCode'">
      <h3 class="form-title">Nhập mã xác nhận</h3>

      <p class="form-subtitle success-message">
        Hệ thống đã gửi mã đến <strong>{{ sentEmail }}</strong>
        vui lòng kiểm tra email.
      </p>

      <form [formGroup]="codeForm" (ngSubmit)="onConfirmCode()">
        <div
          class="notification-bar"
          *ngIf="notification"
          [class.success]="notification.type === 'success'"
          [class.error]="notification.type === 'error'"
        >
          <span class="icon">!</span>
          {{ notification.message }}
        </div>
        <div class="form-group">
          <input type="text" placeholder="Mã xác nhận" formControlName="code" />
        </div>

        <button type="submit" class="submit-button">Xác nhận</button>
      </form>

      <p class="resend-link">
        <a [class.disabled]="!canResend" (click)="onResendCode()">
          Gửi lại mã <span *ngIf="!canResend">({{ countdown }} giây)</span>
        </a>
      </p>

      <p class="switch-link">
        <a (click)="onLoginClick()">Quay lại trang đăng nhập</a>
      </p>
    </ng-container>
  </div>

  <!-- === GIAO DIỆN 3: FORM ĐỔI MẬT KHẨU (MỚI) === -->
  <div>
    <ng-container *ngIf="currentView === 'resetPassword'">
      <h3 class="form-title">Đổi mật khẩu</h3>
      <p class="form-subtitle">Nhập mật khẩu mới của bạn.</p>

      <form [formGroup]="resetForm" (ngSubmit)="onResetPasswordSubmit()">
        <div
          class="notification-bar"
          *ngIf="notification"
          [class.success]="notification.type === 'success'"
          [class.error]="notification.type === 'error'"
        >
          <span class="icon">!</span>
          {{ notification.message }}
        </div>
        <div class="form-group">
          <input type="password" placeholder="Mật khẩu mới" formControlName="newPassword" />
        </div>
        <div class="form-group">
          <input
            type="password"
            placeholder="Xác nhận mật khẩu mới"
            formControlName="confirmPassword"
          />
        </div>

        <button type="submit" class="submit-button">Đổi Mật Khẩu</button>
      </form>

      <p class="switch-link">
        <a (click)="onLoginClick()">Quay lại trang đăng nhập</a>
      </p>
    </ng-container>
  </div>
</div>
