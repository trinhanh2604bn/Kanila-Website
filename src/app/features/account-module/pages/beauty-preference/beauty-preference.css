/* --- CONTAINER CHUNG --- */
.beauty-preference-container {
  display: flex;
  flex-direction: column;
  gap: 15px;
  max-width: 1200px;
  padding: 10px;
  background-color: var(--color-beige);
}

.title {
  font-family: var(--font-nunito);
  font-weight: var(--font-weight-black);
  color: var(--color-red);
  font-size: var(--font-size-xl);
  margin-bottom: 0;
}

.des {
  font-family: var(--font-nunito);
  font-weight: var(--font-weight-medium);
  color: var(--color-red);
  font-size: var(--font-size-m);
  margin-top: 0;
  margin-bottom: 0;
}

.divider-row {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 3px;
  margin-bottom: 0;
}

/* Hiệu ứng xoay cho các bông hoa khi hover vào */
.flower {
  display: inline-block;
  transition: transform 0.3s ease-in-out;
}

.flower:hover {
  transform: rotate(360deg);
}

.flower:hover img {
  transform: rotate(360deg) scale(1.3); /* Xoay và phóng to nhẹ */
}

.flower img {
  transition: transform 0.3s ease-in-out;
}

/* --- FILTER GROUP (Màu Da, Thương Hiệu, v.v.) --- */
.filter-group {
  background-color: var(--color-beige); /* Nền hồng nhạt */
  border-radius: var(--radius-md); /* 6px */
  overflow: hidden; /* Để content ẩn đi khi không expanded */
  border-bottom: 1px solid var(--color-brown); /* Viền default */
  transition: all 0.2s ease-in-out;
}

.filter-group.is-expanded {
  border-bottom: 1px solid var(--color-brown);
}

.filter-header {
  display: flex;
  align-items: center;
  padding: var(--space-4) var(--space-5); /* 12px 16px */
  cursor: pointer;
  font-family: var(--font-nunito);
  font-weight: var(--font-weight-medium); /* SemiBold 600 */
  color: var(--color-red);
  font-size: var(--font-size-l);
}

.filter-label {
  flex-grow: 1; /* Chiếm hết không gian còn lại */
  font-size: var(--font-size-l); /* 20px */
  font-family: var(--font-nunito);
  font-weight: var(--font-weight-extraBold); /* SemiBold 600 */
  color: var(--color-red);
}

/* Trạng thái đã chọn hiển thị ở default (Hình 5) */
.filter-selected-display {
  font-size: var(--font-size-m); /* 16px */
  color: var(--color-red);
  margin-right: var(--space-2); /* 8px */
  white-space: nowrap;
  text-shadow: 0 5px 10px rgba(171, 19, 19, 0.323);
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 50%; /* Giới hạn chiều rộng để không đẩy arrow ra ngoài */
}

.arrow-icon {
  width: 24px;
  height: 24px;
  transition: transform 0.2s ease-in-out;
  color: var(--color-brown);
}

.filter-group.is-expanded .arrow-icon {
  transform: rotate(180deg); /* Xoay mũi tên lên khi mở */
}

/* --- FILTER CONTENT (Hình 2) --- */
.filter-content {
  padding: var(--space-2) var(--space-4) var(--space-4); /* 8px 16px 16px */
  background-color: var(--color-beige); /* Nền trắng */
  border-top: none;
}

.option-buttons {
  display: flex;
  flex-wrap: wrap; /* Cho phép xuống hàng */
  gap: var(--space-4);
  justify-content: center; /* 8px */
}

.option-button {
  background-color: var(--color-pink2); /* Nền nút default */
  border: none;
  border-radius: var(--radius-md); /* 6px */
  padding: var(--space-2) var(--space-3); /* 8px 12px */
  cursor: pointer;
  font-family: var(--font-nunito);
  font-size: var(--font-size-m); /* 16px */
  font-weight: var(--font-weight-medium);
  color: var(--color-brown);
  box-shadow: 0 5px 10px rgba(171, 19, 19, 0.162);
  white-space: nowrap;
  min-width: 180px;
  text-align: center;
  transition: transform 0.5s;
}

.option-button:hover {
  background-color: var(--color-beige);
  color: var(--color-brown);
  border: 1px solid var(--color-brown);
  transform: scale(1.05);
}

.option-button.is-selected {
  background-color: var(--color-red);
  color: var(--color-beige);
  font-weight: var(--font-weight-extraBold);
}

/* --- BRAND SEARCH INPUT (Hình 3) --- */
.filter-content.brand-search-input {
  display: flex;
  flex-direction: column;
  gap: var(--space-3);
  align-items: center;
}

.search-input-wrapper {
  position: relative;
  display: flex;
  align-items: center;
  border: 1px solid var(--color-pink3); /* Màu viền input */
  border-radius: 20px;
  padding: var(--space-2); /* 8px */
  background-color: var(--color-white);
  cursor: pointer; /* Để click mở overlay */
  width: 500px;
  justify-content: center;
}

.search-input-wrapper input {
  flex-grow: 1;
  border: none;
  outline: none;
  font-family: var(--font-nunito);
  font-size: var(--font-size-s);
  color: var(--color-brown);
  background-color: transparent;
  cursor: pointer; /* Để click mở overlay */
}
.search-input-wrapper input::placeholder {
  color: var(--color-grey);
}

.apply-button {
  width: 100%;
  background-color: var(--color-pink3); /* Màu hồng nhạt cho Apply */
  color: var(--color-beige);
  border: none;
  border-radius: 20px;
  padding: var(--space-2) var(--space-3);
  font-family: var(--font-nunito);
  font-size: var(--font-size-s);
  font-weight: var(--font-weight-extraBold);
  width: fit-content;
  align-items: center;
  cursor: pointer;
  transition: background-color 0.2s ease;
}
.apply-button:hover {
  background-color: var(--color-red);
}

/* --- BRAND OVERLAY (Hình 4) --- */
.brand-overlay {
  position: fixed;
  background-color: var(--color-white);
  z-index: 1000; /* Đảm bảo nổi lên trên mọi thứ */
  display: flex;
  flex-direction: column;
  padding: var(--space-4);

  top: 50%;
  left: 50%;
  width: 90vw;
  max-width: 650px;
  max-height: 80vh;
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-medium);

  /* === 2. HIỆU ỨNG POP/BOUNCE (Trạng thái ẩn) (Sửa) === */
  opacity: 0;
  visibility: hidden;
  /* Dùng translate(-50%, -50%) để căn giữa chính xác */
  /* Dùng scale(0.9) để tạo hiệu ứng "nảy" nhỏ */
  transform: translate(-50%, -50%) scale(0.9);

  /* Transition cho mượt
      cubic-bezier(0.34, 1.56, 0.64, 1) là một hiệu ứng "nảy" (bounce/pop) đẹp
    */
  transition: opacity 0.3s ease-out, transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.brand-overlay.is-open {
  /* === 3. TRẠNG THÁI HIỆN (Sửa) === */
  opacity: 1;
  visibility: visible;
  /* Trở về vị trí căn giữa và scale 100% */
  transform: translate(-50%, -50%) scale(1);
}

.overlay-backdrop {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.5); /* Nền mờ */
  z-index: 999;
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.3s ease, visibility 0.3s ease;
}

.overlay-backdrop.is-open {
  opacity: 1;
  visibility: visible;
}

.overlay-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: var(--space-4);
  display: flex;
}

.overlay-title {
  font-family: var(--font-nunito);
  font-size: var(--font-size-l); /* 25px */
  font-weight: var(--font-weight-extraBold);
  color: var(--color-red);
  display: flex;
}

.close-overlay-btn {
  background: none;
  border: none;
  font-size: var(--font-size-l);
  color: var(--color-grey);
  cursor: pointer;
}

.overlay-search-bar {
  position: relative;
  display: flex;
  align-items: center;
  border: 1px solid var(--color-pink3);
  border-radius: var(--radius-md);
  padding: var(--space-2);
  margin-bottom: var(--space-4);
}
.overlay-search-bar input {
  flex-grow: 1;
  border: none;
  outline: none;
  font-family: var(--font-nunito);
  font-size: var(--font-size-m);
  color: var(--color-brown);
}
.overlay-search-bar svg {
  width: 20px;
  height: 20px;
  color: var(--color-grey);
  margin-left: var(--space-2);
}

.brand-list-content {
  flex-grow: 1; /* Cho phép cuộn */
  overflow-y: auto;
  padding-right: var(--space-2); /* Để tạo khoảng trống cho scrollbar */
}

.brand-section {
  margin-bottom: var(--space-4);
}

.brand-section-letter {
  font-family: var(--font-nunito);
  font-size: var(--font-size-l);
  font-weight: var(--font-weight-extraBold);
  color: var(--color-red);
  margin-bottom: var(--space-3);
  padding-bottom: var(--space-1);
  border-bottom: 1px solid var(--color-pink1);
}

.brand-buttons-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr); /* 3 cột như hình 4 */
  gap: var(--space-2) var(--space-4); /* 8px 16px */
}

.brand-button {
  background: none;
  border: none;
  text-align: left;
  cursor: pointer;
  font-family: var(--font-nunito);
  font-size: var(--font-size-m);
  font-weight: var(--font-weight-medium);
  color: var(--color-brown);
  transition: color 0.2s ease;
}
.brand-button:hover {
  color: var(--color-red);
}

.brand-button.is-selected {
  font-weight: var(--font-weight-extraBold);
  color: var(--color-red);
  text-decoration: underline;
  text-underline-offset: 4px;
}

.overlay-footer {
  padding-top: var(--space-4);
  border-top: 1px solid var(--color-pink1);
  display: flex;
  justify-content: center;
}

.global-apply-btn {
  width: 100%;
  margin-top: var(--space-4); /* Tạo khoảng cách với filter cuối */
  background-color: var(--color-red); /* Đảm bảo nút có màu đỏ */
  color: var(--color-beige);
  font-family: var(--font-nunito);
  font-size: var(--font-size-m);
  font-weight: var(--font-weight-extraBold);
  width: 150px;
  align-self: center;
  transform: scale(0.95);
  animation: btn-bounce 0.25s ease-out;
}

.global-apply-btn:hover {
  transform: scale(0.97);
  color: var(--color-red);
  background-color: var(--color-beige);
  border: 1px solid var(--color-red);
}

/* --- RESPONSIVE --- */
/* Khi thu nhỏ màn hình, overlay sẽ chiếm toàn bộ chiều rộng, và grid brands có thể giảm cột */
@media (max-width: 768px) {
  .beauty-preference-container {
    max-width: 100%; /* Cho phép container chiếm toàn bộ chiều rộng */
  }

  .filter-header {
    padding: var(--space-2) var(--space-3); /* Giảm padding */
  }
  .filter-label {
    font-size: var(--font-size-m); /* Giữ kích thước label */
  }
  .filter-selected-display {
    font-size: var(--font-size-m);
    max-width: 40%;
  }

  /* Overlay trên mobile */
  .brand-overlay {
    padding: var(--space-3);
    width: 100vw; /* Chiếm toàn bộ viewport width */
    height: 100vh; /* Chiếm toàn bộ viewport height */
    top: 0;
    left: 0;
  }

  .overlay-title {
    font-size: var(--font-size-l);
  }

  .brand-section-letter {
    font-size: var(--font-size-m);
  }

  .brand-buttons-grid {
    grid-template-columns: repeat(2, 1fr); /* 2 cột trên màn hình nhỏ hơn */
    gap: var(--space-2);
  }

  .brand-button {
    font-size: var(--font-size-s);
  }
}

@media (max-width: 767px) {
  .brand-overlay {
    width: 95vw;
    max-width: 95vw;
    max-height: 90vh;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) scale(0.9);
  }

  .brand-overlay.is-open {
    transform: translate(-50%, -50%) scale(1);
  }

  /* (Các style mobile khác của bạn) */
  .brand-buttons-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}
